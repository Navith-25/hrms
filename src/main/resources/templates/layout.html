<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRMS Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
</head>
<body>

<nav class="sidebar">
    <div class="sidebar-brand">
        <i class="bi bi-people-fill"></i> DG5 HRMS
    </div>

    <ul class="sidebar-menu">
        <li>
            <a th:href="@{/}" class="sidebar-link">
                <i class="bi bi-grid-1x2-fill"></i> <span>Dashboard</span>
            </a>
        </li>
        <li>
            <a th:href="@{/messages}" class="sidebar-link">
                <i class="bi bi-chat-dots-fill"></i> <span>Messages</span>
            </a>
        </li>
        <li>
            <a th:href="@{/my-calendar}" class="sidebar-link">
                <i class="bi bi-calendar-event-fill"></i> <span>My Calendar</span>
            </a>
        </li>

        <li class="menu-header">Self Service</li>

        <li>
            <a th:href="@{/leave}" class="sidebar-link">
                <i class="bi bi-briefcase-fill"></i> <span>My Leave</span>
            </a>
        </li>
        <li>
            <a th:href="@{/payslips}" class="sidebar-link">
                <i class="bi bi-cash-stack"></i> <span>My Payslips</span>
            </a>
        </li>
        <li>
            <a th:href="@{/performance}" class="sidebar-link">
                <i class="bi bi-graph-up-arrow"></i> <span>My Performance</span>
            </a>
        </li>

        <li sec:authorize="!hasAnyRole('MANAGER', 'HR_MANAGER', 'ADMIN', 'DIRECTOR')">
            <a th:href="@{/employee/tasks}" class="sidebar-link">
                <i class="bi bi-list-check"></i> <span>My Tasks</span>
            </a>
        </li>
        <li sec:authorize="!hasAnyRole('MANAGER', 'HR_MANAGER', 'ADMIN', 'DIRECTOR', 'FINANCE')">
            <a th:href="@{/loan/request}" class="sidebar-link">
                <i class="bi bi-bank"></i> <span>Request Loan</span>
            </a>
        </li>
        <li sec:authorize="!hasAnyRole('MANAGER', 'HR_MANAGER', 'ADMIN', 'DIRECTOR')">
            <a th:href="@{/employee/trainings}" class="sidebar-link">
                <i class="bi bi-mortarboard-fill"></i> <span>My Trainings</span>
            </a>
        </li>

        <div sec:authorize="hasAnyRole('MANAGER', 'HR_MANAGER')">
            <li class="menu-header">Management</li>
            <li>
                <a th:href="@{/manager/leave}" class="sidebar-link">
                    <i class="bi bi-calendar-check"></i> <span>Approve Leave</span>
                </a>
            </li>
            <li>
                <a th:href="@{/manager/performance}" class="sidebar-link">
                    <i class="bi bi-star-fill"></i> <span>Team Reviews</span>
                </a>
            </li>
            <li>
                <a th:href="@{/manager/tasks}" class="sidebar-link">
                    <i class="bi bi-clipboard-check"></i> <span>Assign Tasks</span>
                </a>
            </li>
            <li>
                <a th:href="@{/manager/training}" class="sidebar-link">
                    <i class="bi bi-person-video3"></i> <span>Assign Training</span>
                </a>
            </li>
        </div>

        <div sec:authorize="hasAnyRole('ADMIN', 'HR_MANAGER', 'HR_STAFF', 'FINANCE', 'DIRECTOR')">
            <li class="menu-header">Administration</li>

            <li sec:authorize="hasRole('HR_STAFF')">
                <a th:href="@{/admin/attendance}" class="sidebar-link">
                    <i class="bi bi-clock-history"></i> <span>Mark Attendance</span>
                </a>
            </li>

            <li sec:authorize="hasAnyRole('ADMIN', 'HR_MANAGER', 'DIRECTOR', 'HR_STAFF')">
                <a th:href="@{/admin/leave}" class="sidebar-link">
                    <i class="bi bi-building-check"></i> <span>All Leave Requests</span>
                </a>
            </li>

            <li sec:authorize="hasAnyRole('FINANCE', 'DIRECTOR', 'HR_MANAGER', 'MANAGER')">
                <a th:href="@{/finance/loans}" class="sidebar-link">
                    <i class="bi bi-currency-dollar"></i> <span>Loan Approvals</span>
                </a>
            </li>

            <li sec:authorize="hasRole('DIRECTOR')">
                <a th:href="@{/admin/training/create}" class="sidebar-link">
                    <i class="bi bi-plus-circle"></i> <span>Create Training</span>
                </a>
            </li>

            <li sec:authorize="hasAnyRole('ADMIN', 'DIRECTOR')">
                <a th:href="@{/admin/reports/employees}" class="sidebar-link">
                    <i class="bi bi-file-earmark-spreadsheet"></i> <span>Reports (CSV)</span>
                </a>
            </li>

            <li sec:authorize="hasRole('ADMIN')">
                <a th:href="@{/admin/system/reset}" class="sidebar-link text-danger">
                    <i class="bi bi-exclamation-triangle-fill"></i> <span>System Reset</span>
                </a>
            </li>
        </div>
    </ul>
</nav>

<div class="main-content">
    <header class="d-flex justify-content-between align-items-center mb-4 pb-3 border-bottom">
        <h4 class="m-0 fw-bold">Welcome, <span class="text-primary" sec:authentication="name">User</span></h4>
        <div class="d-flex align-items-center">
            <form th:action="@{/logout}" method="post">
                <button type="submit" class="btn btn-outline-danger btn-sm">
                    <i class="bi bi-box-arrow-right"></i> Logout
                </button>
            </form>
        </div>
    </header>

    <div layout:fragment="content">
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>